C51 COMPILER V9.56.0.0   DISPLAY                                                           01/03/2018 10:45:51 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE DISPLAY
OBJECT MODULE PLACED IN .\Objects\display.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE display.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\d
                    -isplay.lst) TABS(2) OBJECT(.\Objects\display.obj)

line level    source

   1          #include"dis.h"
*** WARNING C318 IN LINE 1 OF display.c: can't open file 'dis.h'
   2          
   3          /*led点阵显示数字函数*/
   4          
   5          //---全局变量声明--//
   6          ulong column;   //点阵列
*** ERROR C129 IN LINE 6 OF display.c: missing ';' before 'column'
   7          ulong row;      //点阵行
   8          ulong dt;
   9          
  10          //--点阵显示数组--//
  11          uchar code tab10[] = 
  12          {0x00, 0x01, 0x00, 0x02, 0x00, 0x04, 0x00, 0x08,
  13           0x00, 0x10, 0x00, 0x20, 0x00, 0x40, 0x00, 0x80,
  14           0x01, 0x00, 0x02, 0x00, 0x04, 0x00, 0x08, 0x00,
  15           0x10, 0x00, 0x20, 0x00, 0x40, 0x00, 0x80, 0x00}; 
  16          
  17           
  18          //--09字模--//
  19          uchar code tab9[] = 
  20          {0, 0, 0, 0, 0, 0, 24, 24, 36, 36, 66, 66, 66, 66, 66,
  21           66, 66, 100, 66, 88, 66, 64, 66, 64, 36, 36, 24, 28, 0, 0, 0, 0} ;
  22          
  23          //--08字模--//
  24          uchar code tab8[] = 
  25          {0, 0, 0, 0, 0, 0, 24, 60, 36, 66, 66, 66, 66, 66, 66, 36,
  26          66, 24, 66, 36, 66, 66, 66, 66, 36, 66, 24, 60, 0, 0, 0, 0};
  27          
  28          //--07字模--//
  29          uchar code tab7[] = 
  30          {0, 0, 0, 0, 0, 0, 24, 126, 36, 34, 66, 34, 66, 16, 66, 16,
  31           66, 8, 66, 8, 66, 8, 66, 8, 36, 8, 24, 8, 0, 0, 0, 0};
  32          
  33          //--06字模--//
  34          uchar code tab6[] = 
  35          {0, 0, 0, 0, 0, 0, 24, 56, 36, 36, 66, 2, 66, 2, 66, 26, 66,
  36           38, 66, 66, 66, 66, 66, 66, 36, 36, 24, 24, 0, 0, 0, 0};
  37          
  38          //--05字模--//
  39          uchar code tab5[] = 
  40          {0, 0, 0, 0, 0, 0, 24, 126, 36, 2, 66, 2, 66, 2, 66, 26, 66,
  41           38, 66, 64, 66, 64, 66, 66, 36, 34, 24, 28, 0, 0, 0, 0};
  42          
  43          //--04字模--//
  44          uchar code tab4[] = 
  45          {0, 0, 0, 0, 0, 0, 24, 32, 36, 48, 66, 40, 66, 36, 66, 36, 66,
  46          34, 66, 34, 66, 126, 66, 32, 36, 32, 24, 120, 0, 0, 0, 0};
  47          
  48          //--03字模--//
  49          uchar code tab3[] = 
  50          {0, 0, 0, 0, 0, 0, 24, 60, 36, 66, 66, 66, 66, 32, 66, 24, 66,
  51           32, 66, 64, 66, 64, 66, 66, 36, 34, 24, 28, 0, 0, 0, 0};
  52          
C51 COMPILER V9.56.0.0   DISPLAY                                                           01/03/2018 10:45:51 PAGE 2   

  53          //--02字模--//
  54          uchar code tab2[] = 
  55          {0, 0, 0, 0, 0, 0, 24, 60, 36, 66, 66, 66, 66, 66, 66, 32, 66,
  56           32, 66, 16, 66, 8, 66, 4, 36, 66, 24, 126, 0, 0, 0, 0};
  57          
  58          //--01字模--//
  59          uchar code tab1[] = 
  60          {0, 0, 0, 0, 0, 0, 24, 8, 36, 14, 66, 8, 66, 8, 66, 8, 66, 8, 66,
  61          8, 66, 8, 66, 8, 36, 8, 24, 62, 0, 0, 0, 0};
  62          
  63          //--00字模--//
  64          uchar code tab0[] = 
  65          {0, 0, 0, 0, 0, 0, 24, 24, 36, 36, 66, 66, 66, 66, 66, 66, 66, 66,
  66          66, 66, 66, 66, 66, 66, 36, 36, 24, 24, 0, 0, 0, 0};
  67          
  68          /*led点阵显示函数*/
  69          void li( ucharx)
  70          {
  71              uchar i;
  72              int k;
  73              while(1)
  74              {
  75                for(k = 0; k < 16; k++)                       //中
  76                {  
  77                  HC595SendData(~tabi[2*k +1],~tabi[2*k],tab1[2*k],tab10[2*k + 1]);      
  78                  HC595SendData(0xff,0xff,0,0);  //清屏
  79                }       
  80              }
  81          }
  82          
  83          /*通过595发送四个字节的数据*/
  84          void HC595SendData(  uchar BT3, uchar BT2,uchar BT1,uchar BT0)
  85          {  
  86            uchar i;
  87            
  88            //--发送第一个字节--//
  89            for(i=0;i<8;i++)
  90            {
  91              MOSIO = BT3 >> 7 ;  //从高位到低位
  92              BT3 <<= 1;
  93          
  94              S_CLK = 0;
  95              S_CLK = 1;    
  96            }
  97          
  98            //--发送第一个字节--//
  99            for(i=0;i<8;i++)
 100            {
 101              MOSIO = BT2 >>7;    //从高位到低位
 102              BT2 <<= 1;
 103          
 104              S_CLK = 0;
 105              S_CLK = 1;  
 106            }
 107          
 108            //--发送第一个字节--//
 109            for(i=0;i<8;i++)
 110            {
 111              MOSIO = BT1 >> 7;   //从高位到低位
 112              BT1 <<= 1;
 113              S_CLK = 0;
 114              S_CLK = 1;  
C51 COMPILER V9.56.0.0   DISPLAY                                                           01/03/2018 10:45:51 PAGE 3   

 115            }
 116          
 117            //--发送第一个字节--//
 118            for(i=0;i<8;i++)
 119            {
 120              MOSIO = BT0 >> 7;   //从高位到低位
 121              BT0 <<= 1;
 122              S_CLK = 0;
 123              S_CLK = 1;
 124            }
 125             
 126            //--输出--//
 127            R_CLK = 0; //set dataline low
 128            R_CLK = 1; //片选
 129            R_CLK = 0; //set dataline low
 130          }

C51 COMPILATION COMPLETE.  1 WARNING(S),  1 ERROR(S)
