#define ARRAYA
#include"array.h"
																							
/*******************************************************************************
* 函 数 名         : cycle
* 函数功能		   : 汉字循环显示函数
* 输    入         : 无
* 输    出         : 无
*******************************************************************************/
void cycle()
{   
	int k, j, ms;

//--点阵显示数组定义--//
	unsigned char tab0[] = {0x00, 0x01, 0x00, 0x02, 0x00, 0x04, 0x00, 0x08,
                             0x00, 0x10, 0x00, 0x20, 0x00, 0x40, 0x00, 0x80,
                             0x01, 0x00, 0x02, 0x00, 0x04, 0x00, 0x08, 0x00,
							 0x10, 0x00, 0x20, 0x00, 0x40, 0x00, 0x80, 0x00};

   unsigned char code tab10[] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

   //--单--//
   unsigned char code tab1[] ={16,4,32,2,248,15,136,8,136,8,248,
                            15,136,8,136,8,248,15,128,0,128,
							0,254,63,128,0,128,0,0,0,0,0};

   //--片--//
   unsigned char code tab2[] ={0,2,8,2,8,2,8,2,248,31,8,
                            0,8,0,8,0,248,7,8,4,8,4,
							8,4,4,4,2,4,0,0,0,0};
   //--机--//
   unsigned char code tab3[] ={8,0,136,15,136,8,190,8,136,
                            8,136,8,156,8,172,8,138,8,136,
							8,136,8,72,40,72,40,40,48,0,0,0,0};
    //--原--//
   unsigned char code tab4[] ={248,63,8,2,8,1,200,31,72,
                            16,200,31,72,16,200,31,8,2,
							72,18,72,34,36,34,4,2,130,3,0,0,0,0};
   //--理--//
   unsigned char code tab5[] ={0,0,192,31,94,18,72,18,
                            200,31,72,18,94,18,200,31,8,
							2,8,2,216,31,6,2,0,2,224,63,0,0,0,0};
   //--及--//
    unsigned char code tab6[] ={0,0,252,7,16,4,16,2,
                            16,2,16,15,16,8,80,4,80,4,
							136,2,8,1,132,2,98,12,24,48,0,0,0,0};
   //--应--//
    unsigned char code tab7[] ={128,0,0,1,252,63,4,0,
                            132,0,4,17,4,18,20,18,36,16,
							68,8,68,8,4,4,4,2,242,63,0,0,0,0};
   //--用--//
   unsigned char code tab8[] ={0,0,248,63,8,33,8,33,8,
                            33,248,63,8,33,8,33,248,63,8,
							33,8,33,4,33,4,33,2,56,0,0,0,0};

    unsigned char code tab9[] = {0,0,0,0,0,0,0,0,0,0,0,
                             0,0,0,0,0,0,0,0,0,0,0,0,
							 0,0,0,0,0,0,0,0,0};

//--定义一个指针数组指向每个汉字--//
	uchar *p[] = 
	            {tab10, tab1, tab2, tab3, tab4, tab5, tab6, tab7, tab8, tab9};						
	while(1)
	{

		for(ms = 20; ms > 0; ms--)	//移动定格时间设置
		{
			for(k = 0; k < 16; k++)	//显示一个字
			{	 						
				HC595SendData(~(*(p[0] + 2*(k+j) + 1)),~(*(p[0] + 2*(k+j) )),tab0[2*k],tab0[2*k + 1]); //因为字模软件取的数组是高电平有效，所以列要取反	    	
			}
			
			//--清屏--//
			HC595SendData(0xff,0xff,0,0);										   //清屏		 
		} 

		
		j++;
		if(j == (10*13) )
		{
			j = 0; 
		}
		
	} 							    		  
}

/*******************************************************************************
* 函 数 名         : HC595SendData
* 函数功能		   : 通过595发送四个字节的数据
* 输    入         : BT3：第四个595输出数值
*                  * BT2: 第三个595输出数值
*                  * BT1：第二个595输出数值
*                  * BT0：第一个595输出数值
* 输    出         : 无
*******************************************************************************/

void HC595SendData(  uchar BT3, uchar BT2,uchar BT1,uchar BT0)
{  
	uchar i;
	
	//--发送第一个字节--//
	for(i=0;i<8;i++)
	{
		MOSIO = BT3 >> 7 ;	//从高位到低位
		BT3 <<= 1;

		S_CLK = 0;
		S_CLK = 1;		
	}

	//--发送第一个字节--//
	for(i=0;i<8;i++)
	{
		MOSIO = BT2 >>7;		//从高位到低位
		BT2 <<= 1;

		S_CLK = 0;
		S_CLK = 1;	
	}

	//--发送第一个字节--//
	for(i=0;i<8;i++)
	{
		MOSIO = BT1 >> 7;		//从高位到低位
		BT1 <<= 1;
		S_CLK = 0;
		S_CLK = 1;	
	}

	//--发送第一个字节--//
	for(i=0;i<8;i++)
	{
		MOSIO = BT0 >> 7;		//从高位到低位
		BT0 <<= 1;
		S_CLK = 0;
		S_CLK = 1;
	}
   
	//--输出--//
	R_CLK = 0; //set dataline low
	R_CLK = 1; //片选
	R_CLK = 0; //set dataline low
}






